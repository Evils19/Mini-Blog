@page "/posts/{id:int}"
@inject BlogDbContext Db
@inject NavigationManager Nav

<PageTitle>Пост</PageTitle>

@if (_loading)
{
    <p>Загрузка...</p>
}
else if (_post is null)
{
    <p>Пост не найден.</p>
}
else
{
    <article class="my-4">
        <h1>@_post.Title</h1>
        <small class="text-muted">@_post.CreatedAt.ToLocalTime().ToString("f")</small>
        <div class="mt-3">@((MarkupString)_post.Content)</div>
        <div class="mt-3">
            <a class="btn btn-secondary" href="/posts">Назад к списку</a>
            <a class="btn btn-outline-primary" href="/admin/posts/@_post.Id/edit">Редактировать</a>
        </div>
    </article>
}

@code {
    [Parameter] public int id { get; set; }
    private Post? _post;
    private bool _loading = true;

    protected override async Task OnParametersSetAsync()
    {
        _post = await Db.Posts.FirstOrDefaultAsync(x => x.Id == id && x.IsPublished);
        _loading = false;
    }
}
